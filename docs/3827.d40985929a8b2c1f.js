"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3827],{3827:(S,F,m)=>{m.r(F),m.d(F,{Tab1PageModule:()=>B});var s=m(4742),p=m(177),a=m(4341),h=m(70),g=m(467),b=m(156);const D={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var f,I=new Uint8Array(16);function C(){if(!f&&!(f=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return f(I)}for(var l=[],_=0;_<256;++_)l.push((_+256).toString(16).slice(1));const k=function T(o,n,i){if(D.randomUUID&&!n&&!o)return D.randomUUID();var t=(o=o||{}).random||(o.rng||C)();if(t[6]=15&t[6]|64,t[8]=63&t[8]|128,n){i=i||0;for(var r=0;r<16;++r)n[i+r]=t[r];return n}return function v(o,n=0){return(l[o[n+0]]+l[o[n+1]]+l[o[n+2]]+l[o[n+3]]+"-"+l[o[n+4]]+l[o[n+5]]+"-"+l[o[n+6]]+l[o[n+7]]+"-"+l[o[n+8]]+l[o[n+9]]+"-"+l[o[n+10]]+l[o[n+11]]+l[o[n+12]]+l[o[n+13]]+l[o[n+14]]+l[o[n+15]]).toLowerCase()}(t)};var e=m(3953);function O(o,n){if(1&o&&(e.j41(0,"ion-select-option",18),e.EFF(1),e.nI1(2,"currency"),e.k0s()),2&o){const i=n.$implicit;e.Y8G("value",i.item_name),e.R7$(),e.Lme(" ",i.item_name," ",e.i5U(2,3,i.item_price,"INR")," ")}}function N(o,n){if(1&o){const i=e.RV6();e.j41(0,"ion-item",12)(1,"ion-label",4),e.EFF(2,"Select Item"),e.k0s(),e.j41(3,"ion-select",13),e.bIt("ionChange",function(){const r=e.eBV(i).index,c=e.XpG();return e.Njj(c.onItemSelected(r))}),e.DNE(4,O,3,6,"ion-select-option",14),e.k0s(),e.j41(5,"ion-label",4),e.EFF(6,"Price"),e.k0s(),e.nrm(7,"ion-input",15),e.j41(8,"ion-label",4),e.EFF(9,"Quantity"),e.k0s(),e.nrm(10,"ion-input",16),e.j41(11,"ion-button",17),e.bIt("click",function(){const r=e.eBV(i).index,c=e.XpG();return e.Njj(c.removeItem(r))}),e.EFF(12,"Remove"),e.k0s()()}if(2&o){const i=n.index,t=e.XpG();e.Y8G("formGroupName",i),e.R7$(4),e.Y8G("ngForOf",t.itemList)}}let j=(()=>{var o;class n{ngOnInit(){console.log(this.itemList)}constructor(t){this.modalCtrl=t,this.itemList=[],this.totalPriceBeforeDiscount=0,this.totalPriceAfterDiscount=0,this.orderForm=new a.gE({customer_Name:new a.MJ("",[a.k0.required]),items:new a.Yp([]),notes:new a.MJ(""),discount:new a.MJ(0,[a.k0.min(0),a.k0.max(100)])}),this.addItem(),this.orderForm.valueChanges.subscribe(()=>{this.calculateTotalPrice()})}get items(){return this.orderForm.get("items")}addItem(){const t=new a.gE({item_name:new a.MJ("",[a.k0.required]),item_price:new a.MJ(0,[a.k0.required,a.k0.min(0)]),quantity:new a.MJ(1,[a.k0.required,a.k0.min(1)])});this.items.push(t)}removeItem(t){this.items.removeAt(t),this.calculateTotalPrice()}calculateTotalPrice(){var t;this.totalPriceBeforeDiscount=this.items.value.reduce((d,u)=>d+u.item_price*u.quantity,0);const c=(null===(t=this.orderForm.get("discount"))||void 0===t?void 0:t.value)||0;this.totalPriceAfterDiscount=this.totalPriceBeforeDiscount*(1-c/100)}onItemSelected(t){const r=this.itemList.find(d=>{var u;return d.item_name===(null===(u=this.items.at(t).get("item_name"))||void 0===u?void 0:u.value)});var c;r&&(null===(c=this.items.at(t).get("item_price"))||void 0===c||c.setValue(r.item_price),this.calculateTotalPrice())}cancel(){return this.modalCtrl.dismiss(null,"cancel")}onSubmit(){if(this.orderForm.valid){let r={order_Data:this.orderForm.value,id:k(),total_Price_BeforeDiscount:this.totalPriceBeforeDiscount,total_Price_AfterDiscount:this.totalPriceAfterDiscount,created_At:new Date};console.log(r),this.modalCtrl.dismiss(r,"confirm")}else console.log("Form is invalid")}}return(o=n).\u0275fac=function(t){return new(t||o)(e.rXU(s.W3))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-order-form"]],inputs:{itemList:"itemList"},decls:40,vars:11,consts:[["slot","end"],["color","medium",3,"click"],[2,"text-align","center"],[3,"ngSubmit","formGroup"],["position","floating"],["formControlName","customer_Name","type","text"],["formArrayName","items"],[3,"formGroupName",4,"ngFor","ngForOf"],["expand","full",3,"click"],["formControlName","discount","type","number"],["formControlName","notes"],["expand","full","type","submit",3,"disabled"],[3,"formGroupName"],["formControlName","item_name",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","item_price","type","number","readonly",""],["formControlName","quantity","type","number"],["color","danger",3,"click"],[3,"value"]],template:function(t,r){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.bIt("click",function(){return r.cancel()}),e.EFF(4,"Cancel"),e.k0s()(),e.j41(5,"ion-title",2),e.EFF(6,"Order Form"),e.k0s()()(),e.j41(7,"ion-content")(8,"form",3),e.bIt("ngSubmit",function(){return r.onSubmit()}),e.j41(9,"ion-item")(10,"ion-label",4),e.EFF(11,"Customer Name"),e.k0s(),e.nrm(12,"ion-input",5),e.k0s(),e.j41(13,"ion-list")(14,"ion-item-group",6),e.DNE(15,N,13,2,"ion-item",7),e.k0s()(),e.j41(16,"ion-button",8),e.bIt("click",function(){return r.addItem()}),e.EFF(17,"Add Another Item"),e.k0s(),e.j41(18,"ion-item")(19,"ion-label",4),e.EFF(20,"Discount (%)"),e.k0s(),e.nrm(21,"ion-input",9),e.k0s(),e.j41(22,"ion-item")(23,"ion-label",4),e.EFF(24,"Notes"),e.k0s(),e.nrm(25,"ion-textarea",10),e.k0s(),e.j41(26,"ion-item")(27,"ion-label"),e.EFF(28,"Total Price (Before Discount):"),e.k0s(),e.j41(29,"ion-label"),e.EFF(30),e.nI1(31,"currency"),e.k0s()(),e.j41(32,"ion-item")(33,"ion-label"),e.EFF(34,"Total Price (After Discount):"),e.k0s(),e.j41(35,"ion-label"),e.EFF(36),e.nI1(37,"currency"),e.k0s()(),e.j41(38,"ion-button",11),e.EFF(39,"Submit Order"),e.k0s()()()),2&t&&(e.R7$(8),e.Y8G("formGroup",r.orderForm),e.R7$(7),e.Y8G("ngForOf",r.items.controls),e.R7$(15),e.JRh(e.i5U(31,5,r.totalPriceBeforeDiscount,"INR")),e.R7$(6),e.JRh(e.i5U(37,8,r.totalPriceAfterDiscount,"INR")),e.R7$(2),e.Y8G("disabled",r.orderForm.invalid))},dependencies:[s.Jm,s.QW,s.W9,s.eU,s.$w,s.uz,s.jh,s.he,s.nf,s.Nm,s.Ip,s.nc,s.BC,s.ai,s.su,s.Je,s.Gw,p.Sq,a.qT,a.BC,a.cb,a.j4,a.JD,a.$R,a.v8,p.oe]}),n})();var y=m(5312),E=m(8472);function A(o,n){if(1&o&&(e.j41(0,"ion-card")(1,"ion-card-content")(2,"ion-item")(3,"ion-label")(4,"strong"),e.EFF(5,"Customer Name:"),e.k0s()(),e.j41(6,"ion-label"),e.EFF(7),e.k0s()(),e.j41(8,"ion-item")(9,"ion-label")(10,"strong"),e.EFF(11,"Total Price (Before Discount):"),e.k0s()(),e.j41(12,"ion-label"),e.EFF(13),e.nI1(14,"currency"),e.k0s()(),e.j41(15,"ion-item")(16,"ion-label")(17,"strong"),e.EFF(18,"Total Price (After Discount):"),e.k0s()(),e.j41(19,"ion-label"),e.EFF(20),e.nI1(21,"currency"),e.k0s()(),e.j41(22,"ion-item")(23,"ion-label")(24,"strong"),e.EFF(25,"Discount Applied:"),e.k0s()(),e.j41(26,"ion-label"),e.EFF(27),e.k0s()()()()),2&o){const i=e.XpG();e.R7$(7),e.JRh(i.customerName),e.R7$(6),e.JRh(e.i5U(14,4,i.totalPriceBeforeDiscount,"INR")),e.R7$(7),e.JRh(e.i5U(21,7,i.totalPriceAfterDiscount,"INR")),e.R7$(7),e.SpI("",i.discount,"%")}}let R=(()=>{var o;class n{constructor(){this.customerName="",this.totalPriceBeforeDiscount=0,this.totalPriceAfterDiscount=0,this.discount=0}ngOnInit(){}}return(o=n).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-order-details-card"]],inputs:{customerName:"customerName",totalPriceBeforeDiscount:"totalPriceBeforeDiscount",totalPriceAfterDiscount:"totalPriceAfterDiscount",discount:"discount"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,r){1&t&&e.DNE(0,A,28,10,"ion-card",0),2&t&&e.Y8G("ngIf",r.customerName)},dependencies:[s.b_,s.I9,s.uz,s.he,p.bT,p.oe]}),n})();function G(o,n){if(1&o&&e.nrm(0,"app-order-details-card",8),2&o){const i=n.$implicit;e.Y8G("customerName",i.order_Data.customer_Name)("totalPriceBeforeDiscount",i.total_Price_BeforeDiscount)("totalPriceAfterDiscount",i.total_Price_AfterDiscount)("discount",i.order_Data.discount)}}function U(o,n){if(1&o&&(e.qex(0),e.DNE(1,G,1,4,"app-order-details-card",7),e.bVm()),2&o){const i=e.XpG();e.R7$(),e.Y8G("ngForOf",i.orderList)}}const w=[{path:"",component:(()=>{var o;class n{constructor(t,r){this.modalCtrl=t,this.authService=r,this.env=y.c.production,this.itemList=[],this.orderList=[],this.app=new b.qw({id:y.c.APP_ID}),this.credentials=b.Ji.anonymous()}ngOnInit(){return(0,g.A)(function*(){})()}ionViewWillEnter(){var t=this;return(0,g.A)(function*(){t.user=yield t.authService.user,console.log(t.user),t.getItems()})()}getItems(){var t=this;return(0,g.A)(function*(){console.assert(t.user.id===t.app.currentUser.id),t.itemList=yield t.user.functions.getItemsData();let r=yield t.user.functions.getOrdersData(),c=yield t.user.functions.getTodaysOrdersData(new Date);t.orderList=r.result,console.log(t.orderList),console.log("todaysOrders",c),t.sortOrderList(),t.totalDayWise(),console.log(t.itemList)})()}sortOrderList(){this.orderList.sort((t,r)=>new Date(r.created_At).getTime()-new Date(t.created_At).getTime())}getOrdersData(){var t=this;return(0,g.A)(function*(){let r=yield t.user.functions.getOrdersData();t.orderList=r.result,console.log(t.orderList)})()}openModal(){var t=this;return(0,g.A)(function*(){const r=yield t.modalCtrl.create({component:j,initialBreakpoint:1,breakpoints:[.25,.5,.75,1],componentProps:{itemList:t.itemList.result}});r.present();const c=yield r.onWillDismiss();if("confirm"===c.role){console.log(c.data);let d=yield t.user.functions.insertOrdersData(c.data);console.log(d),d.success&&(t.orderList.push(c.data),t.sortOrderList(),t.totalDayWise())}})()}totalDayWise(){const t=new Map;this.orderList.forEach(c=>{const u=new Date(c.created_At).toISOString().split("T")[0];t.has(u)?t.set(u,t.get(u)+c.total_Price_AfterDiscount):t.set(u,c.total_Price_AfterDiscount)});const r=Array.from(t.entries()).map(([c,d])=>({day:c,earning:d}));console.log(r),localStorage.setItem("Earning_History",JSON.stringify(r))}logout(){this.authService.logout()}}return(o=n).\u0275fac=function(t){return new(t||o)(e.rXU(s.W3),e.rXU(E.u))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-tab1"]],decls:10,vars:3,consts:[[3,"translucent"],[2,"margin-top","13%"],[2,"text-align","center"],["id","open-modal",3,"click"],["name","add-circle"],[3,"fullscreen"],[4,"ngIf"],[3,"customerName","totalPriceBeforeDiscount","totalPriceAfterDiscount","discount",4,"ngFor","ngForOf"],[3,"customerName","totalPriceBeforeDiscount","totalPriceAfterDiscount","discount"]],template:function(t,r){1&t&&(e.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title",2),e.EFF(3," New Order "),e.k0s(),e.j41(4,"ion-card")(5,"ion-card-content",2)(6,"ion-button",3),e.bIt("click",function(){return r.openModal()}),e.nrm(7,"ion-icon",4),e.k0s()()()()(),e.j41(8,"ion-content",5),e.DNE(9,U,2,1,"ng-container",6),e.k0s()),2&t&&(e.Y8G("translucent",!0),e.R7$(8),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("ngIf",r.orderList.length>0))},dependencies:[s.Jm,s.b_,s.I9,s.W9,s.eU,s.iq,s.BC,s.ai,p.Sq,p.bT,R]}),n})()}];let L=(()=>{var o;class n{}return(o=n).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[h.iI.forChild(w),h.iI]}),n})(),B=(()=>{var o;class n{}return(o=n).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[s.bv,p.MD,a.YN,L,a.X1]}),n})()}}]);